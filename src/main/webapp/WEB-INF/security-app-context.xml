<beans:beans
	xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans.xsd
                    http://www.springframework.org/schema/security
                    http://www.springframework.org/schema/security/spring-security.xsd">
	<beans:import resource="classpath*:applicationContext.xml" />
	<beans:bean name="pbkdf2Encoder"
		class="org.springframework.security.crypto.password.Pbkdf2PasswordEncoder" />
	<http pattern="/resources/**" security="none" />
	<http pattern="/employee/**"
		authentication-manager-ref="authenticationMgr">
		<access-denied-handler error-page="/403employee" />
		<logout logout-url="/employee/j_spring_security_logout"
			logout-success-url="/employee/login" invalidate-session="true" />
		<intercept-url pattern="/employee/admin"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/myincidents"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/beforeday"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/againday"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/in"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/out"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/newoperation"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/daily"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/newconcept"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/newincome"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/newincident"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/searchschedule"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/newgratification"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/registernumber"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/lastgratifications"
			access="hasRole('ROLE_USER')" />
		<intercept-url
			pattern="/employee/newpaymentchangemachine"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/newmoneyadvance"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/newopenmachine"
			access="hasRole('ROLE_USER')" />
		<intercept-url pattern="/employee/extrahours"
			access="hasRole('ROLE_USER')" />
		<form-login login-page="/employee/login"
			default-target-url="/employee/admin"
			authentication-failure-url="/employee/login"
			always-use-default-target="true"
			login-processing-url="/employee/jspringsecuritychecke" />
	</http>

	<http pattern="/admin/**"
		authentication-manager-ref="authenticationMgr">
		<access-denied-handler error-page="/403admin" />
		<logout logout-url="/admin/j_spring_security_logout"
			logout-success-url="/admin/login" invalidate-session="true" />
		<intercept-url pattern="/admin/admin"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/newcalendar"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/searchschedule"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/calendar"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/daily"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/calendar"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/newentrysafe"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/newentrymoney"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/newentrymachine"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/againday*"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/beforeday*"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/updateoperation*"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/pendingissues"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/totalsafe"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/luckiaAward"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/reset"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/searchmonthreset"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/newmessage"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/messages"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/searchticketsByDay"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/changemachinetotal"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/newentryvisible"
			access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/admin/searchregister"
			access="hasRole('ROLE_ADMIN')" />
		<form-login login-page="/admin/login"
			default-target-url="/admin/admin"
			authentication-failure-url="/admin/login"
			always-use-default-target="true"
			login-processing-url="/admin/jspringsecuritycheck" />
	</http>

	<http authentication-manager-ref="authenticationMgr">
		<access-denied-handler error-page="/403" />
		<logout logout-url="/j_spring_security_logout"
			logout-success-url="/login" invalidate-session="true" />
		<form-login login-page="/login"
			default-target-url="/adminboss" authentication-failure-url="/login"
			always-use-default-target="true" />
		<intercept-url pattern="/adminboss"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/newuser"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/newentrymoney"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/searchschedule"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/summaryincome"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/summaryexpenses"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/searchregister"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/searchrecharges"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/daily"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/searchtpv"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/searchentrysortsafe"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/enabledisableuser"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/searchopenmachines"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/newtpv"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/extrahours"
			access="hasRole('ROLE_BOSS')" />
		<intercept-url pattern="/manualpayments"
			access="hasRole('ROLE_BOSS')" />
	</http>

	<authentication-manager id="authenticationMgr">
		<authentication-provider>
			<password-encoder ref="pbkdf2Encoder" />
			<jdbc-user-service role-prefix="ROLE_"
				data-source-ref="dataSource"
				users-by-username-query="select username,password, enabled from users where username=?"
				authorities-by-username-query="select username, role from roles where username =?  " />
		</authentication-provider>
	</authentication-manager>
</beans:beans>  